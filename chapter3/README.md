第三章 流水
========================

提纲
------------
* 流水基本概念
* 流水性能
* 指令相关问题
* 异步流水(多发射?)
* 流水实例

3.1 重叠解释方式
-----------------------

### 基本步骤
取指令 --> 分析 --> 执行

### 相关处理（依赖性）
1. 指令相关
2. 主存空间数相关
3. 通用寄存器相关

### 推迟？一次/二次相关？
P14-P15表示不懂，看教材（或者是组成原理的教材）
操作数等看组成原理

3.2 流水方式
-----------------------

### 指令可以解析为子过程
* 粗分: 分析 --> 执行
* 细分: 取指令 --> 指令译码 --> 取操作数 --> 执行

### 流水线的分类
* 按流水处理级别（就是在什么级别上流水）： 部件，处理器，系统
* 按功能划分：单功能， 多功能（分动态，静态。什么意思？）
* 按数据表示: 标量流水，向量流水
* 按是否有反馈：线性流水，非线性流水（反馈可能改变流水的方向和步骤）
* 按维度：一维，多维（脉动阵列流水，什么东西？）

### 流水处理机的性能指标
* 绝对性能：吞吐率 TP
* 相对性能：效率， 加速比 Sp (Speedup)

### 吞吐率 TP
流水线在单位时间完成的任务数

### 瓶颈子过程(最慢子过程)
影响这个流水线的效率。最大吞吐率取决于瓶颈段的时间。  
解决办法：
	1. 瓶颈子过程再细分(原子指令再分成更细的部分，从而并行化)
	2. 瓶颈子过程并联(P31)

### 效率(设备时间利用率)
设备实际使用时间占整个运行时间之比（运行的时候可能有的设备是排空的）。

### 影响效率的因素
1. 只有一个功能的流水线在工作（那么无法并行）
2. 流水填充空闲期（？）
3. 功能切换的流水停顿期
4. 数据相关问题（由于有数据相关性，这里只能白等）

### 数据相关性的分类
* 局部相关性
* 全局相关性

### 评价流水机器
1. 吞吐率和效率
2. 相关检测技术和处理技术

### 局部相关性的处理
1. 顺序流水（只有读写先后相关）
2. 异步流水（有 写-写， 读-写，写-读 三种相关）
（怎么理解？看教材）

### 全局相关性的处理
1. 猜测法
2. 加快和提前形成条形码
3. 采取延迟转移
4. 加快短循环程序的处理
（不理解，看教材）

### 流水机器的中断处理
主要关注如何保存断点和恢复，而不是如何缩短流水线的时间。

### 流水线调度
已知预约表，如何求：延迟禁止表、冲突向量、状态转移图、最佳周期性调度方案(最新平均延迟、最大吞吐率)等


3.3 Intel处理器实例
-----------------------
略


3.4 向量的流水处理与向量流水处理机
-----------------------
比标量流水效率更高  

### 两种处理方式
1. 向量的横向处理
2. 向量的纵向处理

### 存储器的支持
数据供给要快，使得流水线充分运作起来。

### 向量处理机的指令系统
1. 向量型（向量运算）
2. 标量型（标量运算）

### 向量流水处理机的结构
p80-p82 涉及到一些硬件、电路

### 提高向量流水性能
每个 Vi 组都有连到 6 个功能部件的单独总线,而每
个功能部件也都有把运算结果送回向量寄存器组的输出总线

### 冲突
1. Vi冲突 - 并行工作的各向量指令的源向量或结果向量使用了相同的 Vi (相当与内存单元不能被两条指令同时访问、同时修改)
2. 功能部件冲突 - 同一个功能部件被一条以上的要求并行工作的向量指令所使用（比如浮点相乘流水功能部件，也就是执行加法的部件一次只能给一条指令使用）


3.5 指令级高度并行的超级处理机
--------------------------

### 分类
1. 超标量处理机
2. 超长指令字处理机
3. 超流水线处理机

知道区别，要会分析性能（P109）,会算加速比（P110）

进度
-------------------------------
2014年 05月 29日 星期四 00:55:59 HKT  
p43  
2014年 05月 29日 星期四 13:20:47 HKT  
Done！ ppt没有详细讲的要看教材  
